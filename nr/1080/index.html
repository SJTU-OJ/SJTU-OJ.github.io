<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=一个SJTUOJ的题解分享网站><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-6.1.2"><title>1080 - SJTUOJ解答集</title><link rel=stylesheet href=../../assets/stylesheets/main.19190aaf.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.24b84193.min.css><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><script type=application/javascript>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date

  /* Set up integration and send page view */
  ga("create", "UA-159960487-2", "oj")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")

  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", function() {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })

  /* Send page view on document switch (instant loading, custom event) */
  document.addEventListener("DOMContentSwitch", function() {
    ga("send", "pageview", document.location.pathname)
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script><script data-ad-client=ca-pub-8161493042440791 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=none data-md-color-accent=none> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#1080-f class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=../.. title=SJTUOJ解答集 class="md-header-nav__button md-logo" aria-label=SJTUOJ解答集> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> SJTUOJ解答集 </span> <span class="md-header-nav__topic md-ellipsis"> 1080 </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/SJTU-OJ/SJTU-OJ.github.io/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> SJTU-OJ/SJTU-OJ.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=SJTUOJ解答集 class="md-nav__button md-logo" aria-label=SJTUOJ解答集> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> SJTUOJ解答集 </label> <div class=md-nav__source> <a href=https://github.com/SJTU-OJ/SJTU-OJ.github.io/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> SJTU-OJ/SJTU-OJ.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> 主页 </a> </li> <li class=md-nav__item> <a href=../ class=md-nav__link> 索引 </a> </li> <li class=md-nav__item> <a href=../../add/ class=md-nav__link> 添加 </a> </li> <li class=md-nav__item> <a href=../../thanks/ class=md-nav__link> 鸣谢 </a> </li> <li class=md-nav__item> <a href=../../about/ class=md-nav__link> 关于 </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#fineartzs-solution class=md-nav__link> FineArtz's solution </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/SJTU-OJ/SJTU-OJ.github.io/edit/master/docs/nr/1080.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <script async defer src=https://buttons.github.io/buttons.js></script> <h1 id=1080-f>1080 小F的公寓</h1> <details> <summary><a href=https://acm.sjtu.edu.cn/OnlineJudge/problem/1080>题目</a></summary> <article class=span9> <h2> Description </h2> <p> 改编自 NOIP2006 树网的核. </p> <p> 小F所在的城市“爱吃米”是一个连通无圈的无向图，每个节点是一幢公寓，两两公寓之间由长度不同的道路相连。 </p> <p> “爱吃米”为了方便大家吃米，两两公寓之间都存在唯一一条简单路径。 </p> <p> 我们用d(a,b)表示以a,b两个公寓为端点的路径的长度，它是该路径上各道路长度之和。我们称d(a,b)为a,b两公寓间的距离。 </p> <p> 一个公寓 v 到一条路径 P 的距离为该公寓与 P 上的最近的公寓的距离： </p> <p> \( d(v，P) = min { d(v，u)，u为路径 P 上的公寓 } \) 。 </p> <p> “爱吃米”的直径：“爱吃米”中最长的路径称为“爱吃米”的直径。 </p> <p> 对于给定的城市T，直径不一定是唯一的，但可以证明： </p> <p> 各直径的中点（不一定恰好是某个结点，可能在某条边的内部）是唯一的，我们称该点为“爱吃米”的中心。 </p> <p> 偏心距ECC(F)：“爱吃米” T 中距路径 F 最远的结点到路径 F 的距离，即 \( ECC(F) = max{ d(v,F), v∈V } \)。 </p> <p> 任务：对于给定的城市 T = (V, E,W ) 和非负整数 s ，小F想请你找一个路径 F ，把这个路径上所有的公寓全部租下来。 </p> <p> 但是， F 必须是某直径上的一段路径（该路径两端均为城市中的公寓结点），其长度不超过s（可以等于s），使偏心距ECC(F)最小。 </p> <p> 我们称这个路径为城市 T = ( V , E, W) 的核（Core）。 </p> <p> 必要时，F可以退化为单个公寓结点。 </p> <p> 一般来说，在上述定义下，核不一定只有一个，但最小偏心距是唯一的。 </p> <p> 样例中，A-B 与 A-C 是两条直径，长度均为20。点 W 是“爱吃米”的中心，EF 边的长度为5。 </p> <p> 如果指定 s = 11，则“爱吃米”的核为路径 DEFG（也可以取为路径 DEF ），偏心距为 8 。 </p> <p> 如果指定s=0（或s=1、s=2），则“爱吃米”的核为结点F，偏心距为12。 </p> <h2> Input Format </h2> <p> 输入包含n行： </p> <p> 第1行，两个正整数n和s，中间用一个空格隔开。其中n为树网结点的个数，s为树网的核的长度的上界。设结点编号依次为1, 2, ..., n。 </p> <p> 从第2行到第n行，每行给出3个用空格隔开的正整数，依次表示每一条边的两个端点编号和长度。例如，“2 4 7”表示连接结点2与4的边的长度为7。 </p> <p> 所给的数据都是正确的，不必检验。 </p> <h2> Output Format </h2> <p> 输出只有一个非负整数，为指定意义下的最小偏心距。 </p> <h2> 说明 </h2> <p> 20分的数据满足：\( 5 \leq n \leq 15 \)。 </p> <p> 70分的数据满足：\( 5 \leq n \leq 80 \)。 这里枚举直径，Floyd，枚举core，枚举树外的点都可以做掉。 </p> <p> 100分的数据满足：\( 5 \leq n \leq 300, 0 \leq s \leq 1000 \)。边长度为不超过1000的正整数。 </p> <p> 100分部分改编自NOIP2007第四题。 </p> <p> 110分的数据满足：\( 5 \leq n \leq 500000, 0 \leq s \leq n \) 。最后结果不超过\( 2^{31}-1 \)。 </p> <p> 解题思路： </p> <p> 本题是NOIP题目，由于数据范围很小，O（N3）、O（N2）、O（N×S）等复杂度的算法都可以获得满分，但实际上存在更优秀的算法。 </p> <p> 题目中要求找的路径必须在树的直径上，如果直接按照描述来，需要找出树的所有直径，而树的直径最多可以是O（N2）级别的， </p> <p> 这样做的话最终复杂度必然会很高，所以必须先对此作出简化。 </p> <p> 树的直径虽然可能很多，但它们的形态是很有规律的，题目描述中就已经给了我们一个很有用的规律： </p> <p> 所有直径的中点是重合于树的中心。 </p> <p> 我们从最简单的情况入手：树有多条直径，长度均为D，所有直径唯一的交集就是树的中心（那么树的中心一定处于一个结点上）。 </p> <p> 那么显而易见，树的形态应该是这样的：从树的中心出发有4条以上没有交集的长度为D／2的路径，不妨称它们为半径。 </p> <p> 显然无论怎样选择核的位置，它最多只能覆盖到两条半径，那么偏心距不可能小于D／2，而直接选择树的中心作为核， </p> <p> 偏心距就已经是D／2了，所以树的中心就是核，而这个核位于所有的直径上。 </p> <p> 如果所有直径的交集不是一个点呢？由于直径是树上的连续路径，而两条连续路径的交集如果不是空集，一定也是连续路径。 </p> <p> 而题目已经告诉了我们，所有直径必定是有交集的，那么交集不是一个点的话，就必然是一段连续的路径，设这个交集为W。 </p> <p> 每一条直径都是W两头再延伸出去一段路径形成的，稍加分析就能证明，对于W的某一头，直径延伸出去的所有路径长度都是相等的， </p> <p> 即如下图（红色部分为W，蓝色部分为直径延伸出去的部分）： </p> <p> <img alt src=111.jpg> </p> <p> 联系前面讨论的“交集为一个点”的情况，会发现这里情况是类似的，如果核覆盖到了蓝色的边，那么将核在蓝色边上的部分删掉，偏心距是不会变化的，所以核一定是在红色的部分上的，换句话说：核在任意一条直径上，这和前一种情况得出的结论是相同的。 </p> <p> 有了这个结论，我们就可以随便找出一条树的直径，再在上面找核了。找树的直径可以使用动态规划算法或者两次dfs的方法，复杂度均为O（N），具体方法不在此文叙述。下面来研究怎样找到核的位置。 </p> <p> 一条直径上最多有O（N）个点，那是否有O（N2）种核的选择方案呢？注意到这样一个性质，向一条路径多加入一条边，偏心距是不会变得更大的，所以如果核在直径上的起点确定了，就可以一直沿着直径向下走，直到走到头或者总长度将要超过S为止，这样一来，核就只有O（N）种选择方案了。 </p> <p> 当选定了一种核的位置后，就需要确定它的偏心距。因为核完全位于直径上，所以任意点要走到核上，一定要先走到直径上，不妨将其走到直径上的第一个点称为“进入点”。由于我们只关心离核最远的点的距离，所以树的结构可以简化为链：对于直径上的每个点，找出以它作为进入点的点中距离最远的一个，称为最远旁枝，这一步是O（N）的。现在要确定核的偏心距，它由三部分产生，第一部分是核上所有点的最远旁枝，第二部分是核头部距离直径头部的距离，第三部分是核尾部距离直径尾部的距离。后两个部分很容易得到，对于第一个部分，实际上是一个RMQ问题，当然可以使用各种RMQ算法解决。但事实上，RMQ也是不必要的，因为我们是从前向后在直径上枚举核的起点，终点的位置也是不会回头的，所以实现一个单调队列就可以在O（N）的时间复杂度解决这个问题。 </p> <p> 综合以上所述的各个步骤，整个算法的复杂度O（N），和输入规模同阶，已经是理论下界。 </p> <h2> Sample Input </h2> <pre><code>5 2
1 2 5
2 3 2
2 4 4
2 5 3
</code></pre> <h2> Sample Output </h2> <pre><code>5
</code></pre> </article> </details> <h2 id=fineartzs-solution>FineArtz's solution <a class=github-button href=https://github.com/FineArtz/SJTUOJ data-icon=octicon-star data-show-count=true aria-label=Star!></a></h2> <div class="cpp codehilite"><pre><span></span><code><span class=cm>/* 小F的公寓 */</span>
<span class=cp>#include</span> <span class=cpf>&lt;iostream&gt;</span><span class=cp></span>
<span class=cp>#include</span> <span class=cpf>&lt;cstring&gt;</span><span class=cp></span>
<span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>

<span class=k>const</span> <span class=kt>int</span> <span class=n>MAXN</span> <span class=o>=</span> <span class=mi>500005</span><span class=p>,</span> <span class=n>INF</span> <span class=o>=</span> <span class=mi>2147483647</span><span class=p>;</span>

<span class=k>class</span> <span class=nc>Edge</span><span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>Edge</span><span class=p>()</span> <span class=o>=</span> <span class=k>default</span><span class=p>;</span>
    <span class=n>Edge</span><span class=p>(</span><span class=kt>int</span> <span class=n>uu</span><span class=p>,</span> <span class=kt>int</span> <span class=n>vv</span><span class=p>,</span> <span class=kt>int</span> <span class=n>ww</span><span class=p>,</span> <span class=kt>int</span> <span class=n>nn</span><span class=p>)</span> <span class=o>:</span> <span class=n>u</span><span class=p>(</span><span class=n>uu</span><span class=p>),</span> <span class=n>v</span><span class=p>(</span><span class=n>vv</span><span class=p>),</span> <span class=n>w</span><span class=p>(</span><span class=n>ww</span><span class=p>),</span> <span class=n>next</span><span class=p>(</span><span class=n>nn</span><span class=p>)</span> <span class=p>{}</span>
    <span class=kt>int</span> <span class=n>u</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>v</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>w</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>next</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>};</span>

<span class=n>Edge</span> <span class=n>e</span><span class=p>[</span><span class=n>MAXN</span><span class=p>];</span>
<span class=kt>int</span> <span class=n>head</span><span class=p>[</span><span class=n>MAXN</span><span class=p>],</span> <span class=n>cnt</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
<span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>s</span><span class=p>;</span>
<span class=kt>int</span> <span class=n>dist</span><span class=p>[</span><span class=n>MAXN</span><span class=p>],</span> <span class=n>father</span><span class=p>[</span><span class=n>MAXN</span><span class=p>];</span>
<span class=kt>int</span> <span class=n>p1</span><span class=p>,</span> <span class=n>p2</span><span class=p>;</span>

<span class=kt>int</span> <span class=n>q</span><span class=p>[</span><span class=n>MAXN</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
<span class=kt>bool</span> <span class=n>v</span><span class=p>[</span><span class=n>MAXN</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>

<span class=kt>void</span> <span class=nf>addEdge</span><span class=p>(</span><span class=kt>int</span> <span class=n>u</span><span class=p>,</span> <span class=kt>int</span> <span class=n>v</span><span class=p>,</span> <span class=kt>int</span> <span class=n>w</span><span class=p>){</span>
    <span class=n>e</span><span class=p>[</span><span class=o>++</span><span class=n>cnt</span><span class=p>]</span> <span class=o>=</span> <span class=n>Edge</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>head</span><span class=p>[</span><span class=n>u</span><span class=p>]);</span>
    <span class=n>head</span><span class=p>[</span><span class=n>u</span><span class=p>]</span> <span class=o>=</span> <span class=n>cnt</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=nf>dis</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>indicator</span><span class=p>){</span>
    <span class=n>memset</span><span class=p>(</span><span class=n>q</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>q</span><span class=p>));</span>
    <span class=n>memset</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>v</span><span class=p>));</span>
    <span class=kt>int</span> <span class=n>front</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>rear</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>ret</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>indicator</span><span class=p>){</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>p2</span><span class=p>;</span> <span class=n>i</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>=</span> <span class=n>father</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
            <span class=n>v</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=n>v</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
    <span class=n>q</span><span class=p>[</span><span class=n>rear</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span><span class=p>;</span>
    <span class=n>dist</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>indicator</span><span class=p>)</span>
        <span class=n>father</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=k>while</span> <span class=p>(</span><span class=n>front</span> <span class=o>!=</span> <span class=n>rear</span><span class=p>){</span>
        <span class=kt>int</span> <span class=n>now</span> <span class=o>=</span> <span class=n>q</span><span class=p>[</span><span class=n>front</span><span class=o>++</span><span class=p>];</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>head</span><span class=p>[</span><span class=n>now</span><span class=p>];</span> <span class=n>i</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>=</span> <span class=n>e</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>next</span><span class=p>){</span>
            <span class=kt>int</span> <span class=n>next</span> <span class=o>=</span> <span class=n>e</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>v</span><span class=p>;</span>
            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>v</span><span class=p>[</span><span class=n>next</span><span class=p>]){</span>
                <span class=n>dist</span><span class=p>[</span><span class=n>next</span><span class=p>]</span> <span class=o>=</span> <span class=n>dist</span><span class=p>[</span><span class=n>now</span><span class=p>]</span> <span class=o>+</span> <span class=n>e</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>w</span><span class=p>;</span>
                <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>indicator</span><span class=p>)</span>
                    <span class=n>father</span><span class=p>[</span><span class=n>next</span><span class=p>]</span> <span class=o>=</span> <span class=n>now</span><span class=p>;</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>dist</span><span class=p>[</span><span class=n>ret</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>dist</span><span class=p>[</span><span class=n>next</span><span class=p>])</span>
                    <span class=n>ret</span> <span class=o>=</span> <span class=n>next</span><span class=p>;</span>
                <span class=n>q</span><span class=p>[</span><span class=n>rear</span><span class=o>++</span><span class=p>]</span> <span class=o>=</span> <span class=n>next</span><span class=p>;</span>
                <span class=n>v</span><span class=p>[</span><span class=n>next</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
    <span class=k>return</span> <span class=n>ret</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span> <span class=nf>main</span><span class=p>(){</span>
    <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>n</span> <span class=o>&gt;&gt;</span> <span class=n>s</span><span class=p>;</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>){</span>
        <span class=kt>int</span> <span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>;</span>
        <span class=n>cin</span> <span class=o>&gt;&gt;</span> <span class=n>u</span> <span class=o>&gt;&gt;</span> <span class=n>v</span> <span class=o>&gt;&gt;</span> <span class=n>w</span><span class=p>;</span>
        <span class=n>addEdge</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>);</span>
        <span class=n>addEdge</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=n>u</span><span class=p>,</span> <span class=n>w</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>p1</span> <span class=o>=</span> <span class=n>dis</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
    <span class=n>p2</span> <span class=o>=</span> <span class=n>dis</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
    <span class=kt>int</span> <span class=n>ans</span> <span class=o>=</span> <span class=n>INF</span><span class=p>,</span> <span class=n>p</span> <span class=o>=</span> <span class=n>p2</span><span class=p>;</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>p2</span><span class=p>;</span> <span class=n>i</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>=</span> <span class=n>father</span><span class=p>[</span><span class=n>i</span><span class=p>]){</span>
        <span class=k>while</span> <span class=p>(</span><span class=n>father</span><span class=p>[</span><span class=n>p</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>dist</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>dist</span><span class=p>[</span><span class=n>father</span><span class=p>[</span><span class=n>p</span><span class=p>]]</span> <span class=o>&lt;=</span> <span class=n>s</span><span class=p>)</span>
            <span class=n>p</span> <span class=o>=</span> <span class=n>father</span><span class=p>[</span><span class=n>p</span><span class=p>];</span>
        <span class=n>ans</span> <span class=o>=</span> <span class=n>min</span><span class=p>(</span><span class=n>ans</span><span class=p>,</span> <span class=n>max</span><span class=p>(</span><span class=n>dist</span><span class=p>[</span><span class=n>p</span><span class=p>],</span> <span class=n>dist</span><span class=p>[</span><span class=n>p2</span><span class=p>]</span> <span class=o>-</span> <span class=n>dist</span><span class=p>[</span><span class=n>i</span><span class=p>]));</span>
    <span class=p>}</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>p2</span><span class=p>;</span> <span class=n>i</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>=</span> <span class=n>father</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
        <span class=n>dis</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
        <span class=n>ans</span> <span class=o>=</span> <span class=n>max</span><span class=p>(</span><span class=n>ans</span><span class=p>,</span> <span class=n>dist</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>ans</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/vendor.7e0ee788.min.js></script> <script src=../../assets/javascripts/bundle.c1ccee15.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>